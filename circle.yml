general:
  branches:
    only:
      - /circle-.*/
machine:
  environment:
    RPC_TESTS_GIT_URL: https://github.com/dexX7/mastercore-rpc-tests.git
dependencies:
  pre:
    - sudo add-apt-repository ppa:boost-latest/ppa -y
    - sudo add-apt-repository ppa:bitcoin/bitcoin -y
    - sudo apt-get update -qq
  override:
    - sudo apt-get install -y build-essential
    - sudo apt-get install -y libtool autotools-dev autoconf
    - sudo apt-get install -y libssl-dev
    - sudo apt-get install -y libboost1.55-all-dev
    - sudo apt-get install -y libdb4.8-dev
    - sudo apt-get install -y libdb4.8++-dev
    - sudo apt-get install -y libqt4-dev
    - sudo apt-get install -y libprotobuf-dev
    - sudo apt-get install -y protobuf-compiler
    - sudo apt-get install -y libqrencode-dev
    - ./autogen.sh
    - ./configure
    - make
test:
  pre:
    - git clone $RPC_TESTS_GIT_URL ./qa/mastercore-rpc-tests
  override:
    - make check
    - ./src/test/test_bitcoin
    - ./src/qt/test/test_bitcoin-qt
    - ./qa/mastercore-rpc-tests/run_tests.py
